#!/bin/bash -e

force="no"
function parseOpts() {
for i in $*; do
case $i in
-f|--force)
force="yes"
;;
*)
echo "Unknown flag $i; $0 [-f|--force]" >&2
exit 1
esac
done
}

if [[ "$force" != "yes" && "$UID" != "0" ]]; then
echo "Must be run as root."
exit 1
fi

UNINSTALLER_TMP_FILE=$(mktemp)
UNINSTALLER_FILE=/var/lib/mechanic/uninstall.sh

function checkForTools() {
local path=""
local tool=""

for tool in $*; do
path=$(which $tool)
if [[ -z "$path" ]]; then
echo "$tool not found."
exit 1
fi
done
}

function streamTar() {
(cat - | base64 -d | gzip -d ) <<EOB
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
Kf1/43SrHQCQAQA=
EOB
}

function checkPreconditions() {
echo "Checking preconditions..."
checkForTools cat tar base64 gzip mktemp sed mv rmdir rm
streamTar | tar tf - | sed -r 's#./(.*)$#/\1#g' | (while read file; do
if [[ "$file" =~ ^.*[^/]$ ]]; then
if [[ -f "$file" ]]; then
echo "$file already exists; aborting."
exit 1
else
echo "$file - ok"
fi
else
echo "$file - ok"
fi
done)
}

function unpack() {
echo "Unpacking..."
streamTar | tar xvf - -C /
}

function generateUninstaller() {
echo "Generating uninstaller..."
streamTar | tar tf - | sort -r | sed -r 's#./(.*)$#/\1#g' | (cat - <<EOB
#!/bin/bash -xe

echo "Uninstalling..."
EOB
while read file; do
if [[ "$file" =~ ^.*/$ ]]; then
if [[ ! -d "$file" ]]; then
echo "rmdir "$file""
fi
else
echo "rm "$file"";
fi
done; cat - <<EOB
echo "Done."

exit 0
EOB
) >$UNINSTALLER_TMP_FILE
}

function relocateUninstaller() {
mv $UNINSTALLER_TMP_FILE $UNINSTALLER_FILE
chmod +x $UNINSTALLER_FILE
}

checkPreconditions
generateUninstaller
unpack
relocateUninstaller

exit 0
