#!/bin/bash -e

force="no"
function parseOpts() {
for i in $*; do
case $i in
-f|--force)
force="yes"
;;
*)
echo "Unknown flag $i; $0 [-f|--force]" >&2
exit 1
esac
done
}

if [[ "$force" != "yes" && "$UID" != "0" ]]; then
echo "Must be run as root."
exit 1
fi

UNINSTALLER_TMP_FILE=$(mktemp)
UNINSTALLER_FILE=/var/lib/mechanic/uninstall.sh

function checkForTools() {
local path=""
local tool=""

for tool in $*; do
path=$(which $tool)
if [[ -z "$path" ]]; then
echo "$tool not found."
exit 1
fi
done
}

function streamTar() {
(cat - | base64 -d | gzip -d ) <<EOB
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
EOB
}

function checkPreconditions() {
echo "Checking preconditions..."
checkForTools cat tar base64 gzip mktemp sed mv rmdir rm
streamTar | tar tf - | sed -r 's#./(.*)$#/\1#g' | (while read file; do
if [[ "$file" =~ ^.*[^/]$ ]]; then
if [[ -f "$file" ]]; then
echo "$file already exists; aborting."
exit 1
else
echo "$file - ok"
fi
else
echo "$file - ok"
fi
done)
}

function unpack() {
echo "Unpacking..."
streamTar | tar xvf - -C /
}

function generateUninstaller() {
echo "Generating uninstaller..."
streamTar | tar tf - | sort -r | sed -r 's#./(.*)$#/\1#g' | (cat - <<EOB
#!/bin/bash -xe

echo "Uninstalling..."
EOB
while read file; do
if [[ "$file" =~ ^.*/$ ]]; then
if [[ ! -d "$file" ]]; then
echo "rmdir "$file""
fi
else
echo "rm "$file"";
fi
done; cat - <<EOB
echo "Done."

exit 0
EOB
) >$UNINSTALLER_TMP_FILE
}

function relocateUninstaller() {
mv $UNINSTALLER_TMP_FILE $UNINSTALLER_FILE
chmod +x $UNINSTALLER_FILE
}

checkPreconditions
generateUninstaller
unpack
relocateUninstaller

exit 0
