#!/bin/bash -e

force="no"
function parseOpts() {
for i in $*; do
case $i in
-f|--force)
force="yes"
;;
*)
echo "Unknown flag $i; $0 [-f|--force]" >&2
exit 1
esac
done
}

if [[ "$force" != "yes" && "$UID" != "0" ]]; then
echo "Must be run as root."
exit 1
fi

UNINSTALLER_TMP_FILE=$(mktemp)
UNINSTALLER_FILE=/var/lib/mechanic/uninstall.sh

function checkForTools() {
local path=""
local tool=""

for tool in $*; do
path=$(which $tool)
if [[ -z "$path" ]]; then
echo "$tool not found."
exit 1
fi
done
}

function streamTar() {
(cat - | base64 -d | gzip -d ) <<EOB
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
EOB
}

function checkPreconditions() {
echo "Checking preconditions..."
checkForTools cat tar base64 gzip mktemp sed mv rmdir rm
streamTar | tar tf - | sed -r 's#./(.*)$#/\1#g' | (while read file; do
if [[ "$file" =~ ^.*[^/]$ ]]; then
if [[ -f "$file" ]]; then
echo "$file already exists; aborting."
exit 1
else
echo "$file - ok"
fi
else
echo "$file - ok"
fi
done)
}

function unpack() {
echo "Unpacking..."
streamTar | tar xvf - -C /
}

function generateUninstaller() {
echo "Generating uninstaller..."
streamTar | tar tf - | sort -r | sed -r 's#./(.*)$#/\1#g' | (cat - <<EOB
#!/bin/bash -xe

echo "Uninstalling..."
EOB
while read file; do
if [[ "$file" =~ ^.*/$ ]]; then
if [[ ! -d "$file" ]]; then
echo "rmdir "$file""
fi
else
echo "rm "$file"";
fi
done; cat - <<EOB
echo "Done."

exit 0
EOB
) >$UNINSTALLER_TMP_FILE
}

function relocateUninstaller() {
mv $UNINSTALLER_TMP_FILE $UNINSTALLER_FILE
chmod +x $UNINSTALLER_FILE
}

checkPreconditions
generateUninstaller
unpack
relocateUninstaller

exit 0
