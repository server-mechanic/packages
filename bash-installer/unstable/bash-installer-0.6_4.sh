#!/bin/bash -e

if [[ "$UID" != "0" ]]; then
echo "Must be run as root."
exit 1
fi

UNINSTALLER_TMP_FILE=$(mktemp)
UNINSTALLER_FILE=/var/lib/mechanic/uninstall.sh

function checkForTools() {
local path=""
local tool=""

for tool in $*; do
path=$(which $tool)
if [[ -z "$path" ]]; then
echo "$tool not found."
exit 1
fi
done
}

function streamTar() {
(cat - | base64 -d | gzip -d ) <<EOB
H4sIAGSvw1gAA+19+1fjOJZw/5y/QuNpDk5PYvIAMkM3tYcGqotvqoAFamr7UJwcEyvgr5I4YzvQ
zJz+31dXL0vyI3ESUl071u50BVm6upKupKv7krPz3aunFkm93h782+7ttdR/Rfqu3W3tt3qd3t7u
7netdqvT6X6H9l4fte++m0WxGyL03SCYTPyCcvO+f6PJ2cHx4JVpYIn57/X2q/nfRGLzP8aDR3fi
vxIhlJ//zt7uXjX/m0jG/I/9h9CN/WDieOujhfLzv9vbb1Xzv4lkzP80iOLmuomg/Pzv9Xar838j
yZz/EK99+peZf/inmv8NJH3+HdLL4drbgAne39/Nm/92r7drzH93t0PO/9baMclI/+Hz/+fan9HN
ox8h8v/xI0ZAAP4DGvojjIZBSPMiHD7hEEkiqUGlt+TjOAgx8iek3JhuGOjJj/wYPcbx9GBnh1Vr
ympB+EBq1m7Hrj+5qxEQtBFoQBRBz/5ohEbBA4oD8t0eYfcJIzyexi/IH6KXYIa8AE2CGD27kzip
FgfoOfRjDD/wb3HoUtD1GoHUh1+H3//7w+nxu6Pzs+P+1cXFTf/k7Or3nSc33CElEuInfwBanh/i
QRyEPo6Qth9GDL97GKXRiJTBHhqGwRjVSLG+LNYnAKLsJgv32oN8LP37/GomygugWxrVJdAsQlHn
MgqGlZRbYlxNHmbRgTXrAdr3boQl7i9sSRCCDEKX/CULo+cg/OJPHpKStXBGES4gPbXteDzNaC29
NqIYlhzZsgixe27sklEbBc81mlGiOVq+Buvf2ZlF4R/u/t9udavzfyOJzX90709ejwiWmP/efq+a
/00kZf7F7rD2NubNP/CGJv/X61T83ybSn/+0A3NPDp5H1MTkCGr+0CTnsEcOswP08eZt86+QU6td
H1+dXdLj5PB7mxw0E3eM0fetOuXjyKHo4acaYdFub1HTQ9b3SfEdx9mZvsSPQUJgFrq7+xEOt0kN
EX6NHKYxuvz15t3F+eXRzbvD75PfB9mAakO/praWOvIoUcOJxyp0nN4OYUxxc+oOvrgPOFoUFUvD
pXwzFsVUg3tycX7z6ers5vTnX29Ojy9OTg+9YBJ7QUyY8FqNQoQJkRBR82fUHCdswPc/1NY5/47s
wzqh6mmJ/X+/1an2/00kJ4OG191G+fnvdveq+d9Iypp/fQ9bvY3y8w8/q/nfRJo//6vrBsvPf29/
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
EOB
}

function checkPreconditions() {
echo "Checking preconditions..."
checkForTools cat tar base64 gzip mktemp sed mv rmdir rm
streamTar | tar tf - | sed -r 's#./(.*)$#/\1#g' | (while read file; do
if [[ "$file" =~ ^.*[^/]$ ]]; then
if [[ -f "$file" ]]; then
echo "$file already exists; aborting."
exit 1
else
echo "$file - ok"
fi
else
echo "$file - ok"
fi
done)
}

function unpack() {
echo "Unpacking..."
streamTar | tar xvf -
}

function generateUninstaller() {
echo "Generating uninstaller..."
streamTar | tar tf - | sort -r | sed -r 's#./(.*)$#/\1#g' | (cat - <<EOB
#!/bin/bash -xe

echo "Uninstalling..."
EOB
while read file; do
if [[ "$file" =~ ^.*/$ ]]; then
if [[ ! -d "$file" ]]; then
echo "rm -r "$file""
fi
else
echo "rm "$file"";
fi
done; cat - <<EOB
echo "Done."

exit 0
EOB
) >$UNINSTALLER_TMP_FILE
}

function relocateUninstaller() {
mv $UNINSTALLER_TMP_FILE $UNINSTALLER_FILE
chmod +x $UNINSTALLER_FILE
}

checkPreconditions
generateUninstaller
unpack
relocateUninstaller

exit 0
